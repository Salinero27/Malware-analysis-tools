IDA python scripts to perform Anatova Ransomware analysis.

- 170fb7438316f7335f34fa1a431afc1676a786f1ad9dee63d78c3f5efd3a0ac0: x64 sample
- Rebuild_Functions.py: Python script to rebuild functions. Anatova leverages an IDA bug in order to mess the functions shown in the loader section disrupting the analysis. The script runs over the binary patching the file in order to rebuild all the functions.

<b>Original</b>

![alt text](https://github.com/Salinero27/Malware-analysis-tools/blob/master/Anatova/f_before.png)

<b>Patched</b>

![alt text](https://github.com/Salinero27/Malware-analysis-tools/blob/master/Anatova/f_after.png)

- decryptStrings.py: Anatova uses two kinds of strings (Ascii and Unicode), both are ciphered using XOR algorithm with different keys. This script decodes the strings renaming the variables identified by IDA.

<b>Original</b>

![alt text](https://github.com/Salinero27/Malware-analysis-tools/blob/master/Anatova/s_before.png)

<b>Decoded</b>

![alt text](https://github.com/Salinero27/Malware-analysis-tools/blob/master/Anatova/s_after.png)

Recommendations or suggestions are always welcome
